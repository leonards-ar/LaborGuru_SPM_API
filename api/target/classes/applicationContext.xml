<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="
    http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.0.xsd">
    
	<bean id="spmLogger" class="com.laborguru.logger.DefaultSpmLogger" factory-method="getInstance">
		<property name="logMessagesConfigResource" value="/log-messages.properties"/>
	</bean>
	
	<bean id="propertyConfigurer" class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
    	<property name="location" value="classpath:spm.properties"/>
	</bean>

    <bean id="jwtSettings" class="com.laborguru.security.config.JwtSettings">
        <property name="tokenExpirationTime" value="3600"/>
        <property name="refreshTokenExpTime" value="86400"/>
        <property name="tokenSigningKey" value="secret"/>
    </bean>

	<bean id="mapper" class="com.fasterxml.jackson.databind.ObjectMapper"/>
    <bean id="jwtTokenFactory" class="com.laborguru.security.model.token.JwtTokenFactory">
        <constructor-arg index="0" ref="jwtSettings"/>
    </bean>

    <bean class="com.laborguru.security.RestAuthenticationEntryPoint"/>
    <bean class="com.laborguru.security.auth.ajax.AjaxAwareAuthenticationSuccessHandler">
        <constructor-arg index="0" ref="mapper"/>
        <constructor-arg index="1" ref="jwtTokenFactory"/>
    </bean>
    <bean class="com.laborguru.security.auth.ajax.AjaxAwareAuthenticationFailureHandler">
        <constructor-arg index="0" ref="mapper"/>
    </bean>

    <bean class="com.laborguru.security.auth.ajax.AjaxAuthenticationProvider">
        <constructor-arg index="0" ref="userService"/>
    </bean>

    <bean class="com.laborguru.security.auth.jwt.JwtAuthenticationProvider">
        <constructor-arg index="0" ref="jwtSettings"/>
    </bean>

    <bean class="com.laborguru.security.auth.jwt.extractor.JwtHeaderTokenExtractor"/>

</beans>

